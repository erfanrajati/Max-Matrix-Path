5 6
3 2 1 7 8 9
4 5 6 1 3 10
7 8 9 2 5 3
6 5 4 9 8 7
1 1 1 1 1 22


5 5
1 1 1 1 5
1 1 1 1 5
1 1 1 1 5
1 1 1 1 5
1 1 1 1 5

5 5
5 5 5 5 5
1 1 1 1 1
1 1 1 1 1
1 1 1 1 1
1 1 1 1 1

Input:
10 10
95 100 32 16 40 5 24 40 78 50
63 84 6 37 29 74 5 73 5 80
28 85 89 100 68 50 91 57 99 92
38 35 26 85 2 30 87 37 85 4
47 55 9 97 58 33 63 37 50 34
12 70 56 3 84 85 50 99 36 64
98 19 92 40 92 50 6 91 12 23
94 26 86 30 13 62 95 33 43 83
71 21 79 79 83 9 76 61 7 72
47 90 51 46 9 98 64 82 27 38

output:
865
0 1 2 2 2 1 2 1 2 2


Phase 2
5 6
3 2 1 O 8 9
4 5 6 X 3 10
7 8 9 X 5 3
6 5 4 X 8 7
1 1 1 X 1 22


Input:
10 10
X 88 X X 98 50 31 48 24 11
X 76 X X 77 16 38 43 77 51
O 70 O X 7 20 86 40 6 39
O 50 O X 49 16 31 49 73 65
X 3 X X 26 49 44 80 67 43
X 85 O X 83 95 34 46 45 56
X 22 X X 32 0 20 13 70 2
X 71 O X 79 75 66 96 47 59
X 98 X O 99 61 13 28 32 65
O 38 X X 8 14 4 42 70 50
Output:
563
9 8 7 8 8 7 7 7 6 7


Input:
10 10
X 63 24 53 X 58 18 92 X 41
X 4 22 30 X 22 62 99 X 0
X 72 17 12 X 30 81 28 X 90
X 98 100 3 X 59 8 13 X 40
X 86 94 48 X 87 68 73 X 3
X 21 83 38 X 61 48 87 O 57
X 98 69 19 O 11 59 85 X 70
O 10 91 95 X 35 71 47 X 4
X 43 8 3 O 12 47 4 X 49
X 16 63 79 X 53 69 76 X 63
Output:
570
7 6 7 7 6 5 4 5 5 6

Phase 3
5 6
3 2 1 O 8 9
4 5 6 X 3 10
7 8 9 X 5 3
6 5 4 X 8 7
1 1 1 X 1 22

output:
39
2 1 0 0 0 

Input:
5 5
45 O 9 83 98
57 O 26 96 0
81 O 25 57 20
15 X 0 97 97
98 X 18 28 71

Output:
302
2 2 2 3 3


Input:
10 10
X 24 62 54 48 53 O O 89 45
X 88 7 53 70 58 X X 15 99
O 77 92 63 87 49 X O 66 8
X 84 100 60 95 38 O O 42 73
O 0 16 1 93 36 O O 70 91
X 62 44 16 16 20 O X 32 77
X 73 28 22 90 97 X X 54 49
O 0 65 41 99 16 X O 88 45
X 57 18 76 53 87 X X 66 49
X 54 49 21 41 65 O X 47 90

Output:
579
4 3 3 2 2 1 0 0 0 1


Input:
10 10
X 24 62 54 48 53 O O 89 45
X 88 7 53 70 58 X X 15 99
O 77 92 63 87 49 X O 66 8
O 84 100 60 95 38 O O 42 73
O 0 16 1 93 36 O O 70 91
X 62 44 16 16 20 O X 32 77
X 73 28 22 90 97 X X 54 49
O 0 65 41 99 16 X O 88 45
X 57 18 76 53 87 X X 66 49
X 54 49 21 41 65 O X 47 90

Output:
579
4 3 3 2 2 1 0 0 0 1